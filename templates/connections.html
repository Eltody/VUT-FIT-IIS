<!doctype html>
<html lang="sk">
    <head>
        <title>CP by (j)Elita</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" href="/static/favicon.ico" type="image/x-icon">
        <link rel="stylesheet" type="text/css" href="/static/style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"> </script>
        <script src="https://kit.fontawesome.com/6079958bc1.js" crossorigin="anonymous"></script>
    </head>
    <body class="background" style="background-image: url(static/background.jpg);">
	    <div id="page">
            <nav class="navbar">
                <div class="container">
                    <div id="logo">
                        <a href='/'>CP <em>by (j)Elita</em></a>
                    </div>
                    <div id="menu">
                        <ul>
                            <a href='/preSignIn' id="login">Prihlásiť sa</a>
                            <div class="dropdown">
                                <a href="#" class="hidden" id="user"></a>
                                <div class="dropdown-content">
                                    <a href="#">Lístky</a>
                                    <a href="#">Profil</a>
                                    <a onclick="signOut()" href="/">Odhlásiť sa</a>
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </nav>
            <header id="header"role="banner">
                <div class="container">
                    <div class="resultFlex">
                        <div class="animate__animated animate__fadeIn animate__faster">
                            <div class="resultWrap">
                                <div class="resultContent">
                                    <h3 id="notFound" class="hidden" style="color: red; margin: 0;">Žiadny spoj nebol nájdený</h3>
                                    <h3 id="Found">Nájdené spoje:</h3>
                                    {% for i in data %}
                                        <div class="resultCon">
                                            <div class="resultConHead">
                                                <a>{{i[2]}}<span>{{i[7]}}</span></a>    <!--i.decode('utf-8')-->
                                                <p>Celkový čas <strong>{{i[8]}}</strong></p>
                                            </div>
                                            <div class="resultConDetails">
                                                <div>
                                                    <p><i class="fas fa-bus"></i></p>
                                                    <p class="dots"><i class="fas fa-ellipsis-v"></i></p>
                                                </div>
                                                <br>
                                                <div>
                                                    <div class="connectionInfo">
                                                        <p>{{i[0]}}</p>
                                                        <p><strong>{{i[5]}}</strong></p>
                                                    </div>
                                                    <pre>{{i[2]}}</pre>
                                                    <pre>{{i[4]}}</pre>
                                                </div>
                                                <br>
                                                <div>
                                                    <p>&zwnj;</p>
                                                    <p>{{i[1]}}</p>
                                                    <p>{{i[3]}}</p>
                                                </div>
                                            </div>
                                            <div class="resultConFooter">
                                                <p><i class="fas fa-user"></i><strong>&ensp;{{i[6]}}&nbsp;</strong>voľných miest</p>
                                                <div style="display: inherit; align-items: center;">
                                                    <p>Cena <strong>{{i[9]}}</strong> </p>  <!--i.decode('utf-8')-->
                                                    <a onclick="buy()" href="#">Do košíka <i class="fas fa-shopping-basket"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    {% endfor %}
                                    <input type="button" id="loadMore" class="buttonSearch" value="Načítať ďalšie spoje"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <footer id="footer">
                <p>Copyright © reserved, Website by <a href="mailto:martin.rakus1@gmail.com?Subject=Email%20z%20webstránky%20CP" target="_top"><i><u>Slovenská (j)Elita.</u></i></a></p>
            </footer>
        </div>
        <!-- Scripts -->
        <script type=text/javascript>
            $(function() {
                $("#loadMore").click(function (event) {
                    var data = [];
                    data = {{data|tojson}};
                    var length = data.length;
                    $.getJSON('/loadMore/' + data[length - 1], { }, function(data) { });
                    return false;
                });
            });
        </script>
        <script>
            var cookies = document.cookie.split('; ');
            var c = [];
            for (var i = 0; i < cookies.length; i++) {
                c.push(cookies[i].split('='));
            }
            if (c[0][0] === "name") {
                document.getElementById("user").classList.remove("hidden");
                document.getElementById("login").classList.add("hidden");
                document.getElementById("user").innerHTML = c[0][1];
            }
            function signOut() {
                document.cookie = "name=; Max-Age=0";
                document.cookie = "email=; Max-Age=0";
                location.reload();
            }
        </script>
        <script>
            var message = "{{data.message}}";
            var name = "{{data.name}}";
            if (message !== '') {
                document.getElementById("user").classList.remove("hidden");
                document.getElementById("login").classList.add("hidden");
                document.getElementById("user").innerHTML = name;
            }
        </script>
        <script>
            var data = "{{data}}";
            if (data === "[]") {
                document.getElementById("notFound").classList.remove("hidden");
                document.getElementById("Found").classList.add("hidden");
            }
        </script>
        <script>
            function buy(){
                var cookies = document.cookie.split('; ');
                var c = [];
                for (var i = 0; i < cookies.length; i++) {
                    c.push(cookies[i].split('='));
                }
                if (c[0][0] === "name") {
                    location.href = "/buy";
                } else {
                    location.href = "/preSignIn";
                }
            }
        </script>
    </body>
</html>